<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{layout/header :: header}"></head>
<body>
<header class="main-header">
    <div class="header-container">
        <h1 class="logo"><a th:href="@{/static}">나의 영감 저장소</a></h1>
        <div class="user-menu">
            <span class="username" >사용자</span>
            <a th:href="@{/templates/user/mypage}" class="btn-mypage">마이페이지</a>
        </div>
    </div>
</header>

<main class="create-page">
    <div class="create-container">
        <h2>게시물 수정</h2>

        <form th:action="@{/templates/post/edit/{id}(id=${post.id})}" method="post"
              enctype="multipart/form-data" id="editForm">
            <!-- 제목 -->
            <div class="form-group">
                <label for="title">제목 *</label>
                <input type="text" id="title" name="title" required maxlength="200"
                       th:value="${post.title}">
            </div>

            <!-- 카테고리 -->
            <div class="form-group">
                <label for="category">카테고리 *</label>
                <select id="category" name="category" required>
                    <option value="디자인" th:selected="${post.category == '디자인'}">디자인</option>
                    <option value="사진" th:selected="${post.category == '사진'}">사진</option>
                    <option value="일러스트" th:selected="${post.category == '일러스트'}">일러스트</option>
                    <option value="라이프스타일" th:selected="${post.category == '라이프스타일'}">라이프스타일</option>
                    <option value="여행" th:selected="${post.category == '여행'}">여행</option>
                    <option value="음식" th:selected="${post.category == '음식'}">음식</option>
                    <option value="패션" th:selected="${post.category == '패션'}">패션</option>
                </select>
            </div>

            <!-- 설명 -->
            <div class="form-group">
                <label for="description">설명</label>
                <textarea id="description" name="description" rows="6"
                          th:text="${post.description}"></textarea>
            </div>

            <!-- 현재 이미지 -->
            <div class="form-group">
                <label>현재 이미지</label>
                <div class="current-images">
                    <div class="current-image-item" th:each="imageUrl : ${post.images}">
                        <img th:src="@{${imageUrl}}" alt="현재 이미지">
                    </div>
                </div>
            </div>

            <!-- 새 이미지 업로드 -->
            <div class="form-group">
                <label for="newImages">새 이미지 (선택)</label>
                <input type="file" id="newImages" name="newImages" accept="image/*"
                       multiple onchange="previewImages(event)">
                <p class="help-text">새 이미지를 선택하면 기존 이미지가 교체됩니다</p>
            </div>

            <!-- 이미지 미리보기 -->
            <div id="imagePreview" class="image-preview"></div>

            <!-- 버튼 -->
            <div class="form-actions">
                <button type="button" onclick="history.back()" class="btn-cancel">취소</button>
                <button type="submit" class="btn-submit">수정하기</button>
            </div>
        </form>
    </div>
</main>

<script th:src="@{/js/post.js}"></script>
</body>
</html>